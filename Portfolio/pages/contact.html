class DownloadManager {
  constructor() {
    this.isDownloading = false;
    this.overlay = null;
    this.progressBar = null;
    this.progressText = null;
    this.syncIcon = null;
    this.contentDiv = null;

    this.init();
  }

  init() {
    this.createProgressOverlay();
    this.bindDownloadButtons();
    this.bindKeyboardEvents();
    this.showInitialOverlay(); // Show the initial overlay when the page loads
  }

  showInitialOverlay() {
    this.showProgress();
    // Simulate a download process for 3 seconds
    setTimeout(() => {
      this.hideProgress();
    }, 3000); // Adjust the duration as needed
  }

  createProgressOverlay() {
    // Create overlay element
    this.overlay = document.createElement("div");
    this.overlay.className = "download-progress-overlay";
    this.overlay.setAttribute("role", "dialog");
    this.overlay.setAttribute("aria-labelledby", "download-title");
    this.overlay.setAttribute("aria-describedby", "download-description");

    // Create content container
    this.contentDiv = document.createElement("div");
    this.contentDiv.className = "download-progress-content";

    // Create content HTML with "Hi" message and security icons
    this.contentDiv.innerHTML = `
            <div class="greeting-container">
                <div class="greeting-icon">
                    <i class="fas fa-shield-alt"></i>
                    <i class="fas fa-biohazard"></i>
                </div>
                <h3 id="download-title">Hi there! <span class="wave">ðŸ‘‹</span></h3>
                <p id="download-description">Securely downloading your CV...</p>
            </div>
            <div class="sync-icon">
                <i class="fas fa-sync-alt"></i>
            </div>
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
            <div class="progress-text">Initializing secure connection...</div>
            <button class="close-progress" style="display: none;">Close</button>
        `;

    this.overlay.appendChild(this.contentDiv);
    document.body.appendChild(this.overlay);

    // Get references to elements
    this.progressBar = this.overlay.querySelector(".progress-bar");
    this.progressText = this.overlay.querySelector(".progress-text");
    this.syncIcon = this.overlay.querySelector(".sync-icon i");
    this.greetingContainer = this.overlay.querySelector(".greeting-container");

    // Bind close button
    const closeBtn = this.overlay.querySelector(".close-progress");
    closeBtn.addEventListener("click", () => this.hideProgress());

    // Close on overlay click
    this.overlay.addEventListener("click", (e) => {
      if (e.target === this.overlay) {
        this.hideProgress();
      }
    });
  }

  // ... (rest of the existing methods remain unchanged)

  showProgress() {
    this.overlay.classList.add("active");
    document.body.style.overflow = "hidden";

    // Add animation to greeting icons
    const shieldIcon = this.overlay.querySelector(".fa-shield-alt");
    const biohazardIcon = this.overlay.querySelector(".fa-biohazard");

    shieldIcon.style.animation = "shieldPulse 2s infinite";
    biohazardIcon.style.animation = "biohazardFloat 3s infinite";

    // Focus management for accessibility
    this.contentDiv.setAttribute("tabindex", "-1");
    this.contentDiv.focus();
  }

  hideProgress() {
    this.overlay.classList.remove("active");
    document.body.style.overflow = ""; // Restore scrolling

    // Reset progress
    this.resetProgress();
  }

  // ... (rest of the existing methods remain unchanged)
}

// Initialize download manager when DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
  new DownloadManager();
});